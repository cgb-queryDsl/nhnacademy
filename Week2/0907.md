# 0907 ì •ë¦¬

### ë¬¸ì œ 1. Thread í´ë˜ìŠ¤ë¥¼ ì´ìš©í•´ ë…ë¦½ì ìœ¼ë¡œ ìˆ˜í–‰ë˜ëŠ” ê°ì²´ ë§Œë“¤ê¸°
- Thread í´ë˜ìŠ¤ë¥¼ í™•ì¥í•´ ë…ë¦½ì ìœ¼ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ê°ì²´ ìƒì„±ì„ ìœ„í•œ í´ë˜ìŠ¤ ì •ì˜
---

### ë¬¸ì œ 1.1 Thread í´ë˜ìŠ¤ í™•ì¥í•´ ì •ì˜
- ì •í•´ì§„ ì‹œê°„ ê°„ê²©ìœ¼ë¡œ ë©”ì„¸ì§€ë¥¼ ì¶œë ¥í•˜ë„ë¡ ì •ì˜.
- ë™ì‘ ì‹œê°„ì´ ê°ê¸° ë‹¤ë¥¸ ë‘ ê°ì²´ ìƒì„±.
- ë‘ê°œì˜ ê°ì²´ë¥¼ ë™ì‘ì‹œì¼œ ì¶œë ¥ ì‹œê°„ ê°„ê²©ì„ í™•ì¸.
- ìŠ¤ë ˆë“œì˜ ë™ì‘ ìƒíƒœì— ëŒ€í•´ í™•ì¸.

### Code
<details>
    <summary> Example1_1 </summary>

```java
public class Example1_1 {

    static class Task extends Thread{
        int mils;

        public Task(int mils) {
            this.mils = mils;
        }

        @Override
        public void run() {
            try {
                Thread.sleep(this.mils);
                System.out.println(Thread.currentThread().getName());
            } catch (InterruptedException e) {
                throw new RuntimeException(e);
            }
        }
    }

    public static void main(String[] args) throws InterruptedException {
        Task task1 = new Task(2000);
        Task task2 = new Task(3000);

        task1.start();
        task2.start();

        for(int i = 0 ; i < 100 ; i++) {
            System.out.printf("%s - %s\n", task1.getState(), task2.getState());
            Thread.sleep(1000);
        }
    }
}

```

```java
//ì¶œë ¥
TIMED_WAITING - TIMED_WAITING
TIMED_WAITING - TIMED_WAITING
Thread-0
TERMINATED - TIMED_WAITING
Thread-1
TERMINATED - TERMINATED
TERMINATED - TERMINATED
TERMINATED - TERMINATED
TERMINATED - TERMINATED
TERMINATED - TERMINATED
```

</details>

---

### ë¬¸ì œ 1.2 í´ë˜ìŠ¤ì— í•„ë“œë¥¼ ì¶”ê°€í•´ì„œ ìŠ¤ë ˆë“œë¥¼ ì¤‘ì§€í•˜ëŠ” ë©”ì„œë“œ ì¶”ê°€
- ë©”ì¸ ìŠ¤ë ˆë“œì—ì„œ ì•ˆì „í•˜ê²Œ ì¢…ë£Œí•˜ëŠ” ê¸°ëŠ¥ ì¶”ê°€.
- `stop()`ì€ ë”ì´ìƒ ê¶Œì¥í•˜ëŠ” ë°©ë²•ì´ ì•„ë‹˜.
- ë¬´í•œ ë°˜ë³µì„ ìœ„í•´ waitìƒíƒœë¡œ ë§Œë“¤ ìˆ˜ ìˆìŒ. ì´ ê²½ìš°, ì¦‰ì‹œ ì¢…ë£Œê°€ ì•„ë‹Œ ìƒíƒœ ë³€ê²½ í›„ ì¢…ë£Œ.

### Code

<details>
    <summary> Example1_2 </summary>

```java
public class Example1_2 {

    static class Task extends Thread {
        int mils;
        boolean stopFlag;

        public Task(int mils) {
            this.mils = mils;
        }

        @Override
        public void run() {
            this.stopFlag = false;
            System.out.println("ìŠ¤ë ˆë“œ [ " + Thread.currentThread().getName() + " ]ì„ ì‹œì‘í•©ë‹ˆë‹¤.");

            try {
                while(!this.stopFlag) {
                    Thread.sleep(this.mils);
                    System.out.println("ìŠ¤ë ˆë“œ [ " + Thread.currentThread().getName() + " ] ë™ì‘ì¤‘");
                }
            } catch (InterruptedException e) {
                System.out.println("ìŠ¤ë ˆë“œ [ " + Thread.currentThread().getName() + " ]ì—ì„œ ì¸í„°ëŸ½íŠ¸ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
            } finally {
                this.stopFlag = false;
            }
            System.out.println("ìŠ¤ë ˆë“œ [ " + Thread.currentThread().getName() + " ]ì„ ì¢…ë£Œí•©ë‹ˆë‹¤.");
        }

        public void stop2() {
            this.stopFlag = true;
        }
    }

    public static void main(String[] args) throws InterruptedException {
        Task task = new Task(1000);
        task.start();
        Thread.sleep(5000);
        task.stop2();
        task.join();
    }
}
```

```java
// ì¶œë ¥
ìŠ¤ë ˆë“œ [ Thread-0 ]ì„ ì‹œì‘í•©ë‹ˆë‹¤.
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-0 ]ì„ ì¢…ë£Œí•©ë‹ˆë‹¤.
```

</details>

<br/>

### Comment
- stopFlag í•„ë“œë¥¼ ì¶”ê°€í•´ì„œ ê´€ë¦¬.
- ìì›ë“¤ì´ ê¼¬ì¼ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ê°•ì œ ì¢…ë£ŒëŠ” ë¬¸ì œê°€ ìƒê¸¸ ìˆ˜ ìˆë‹¤.
- ê·¸ê²°ê³¼ë¡œ ì“¸ë°ì—†ì´ ì˜¤ë˜ ëŒ€ê¸°í•˜ëŠ” ë¬¸ì œê°€ ìƒê¸´ë‹¤.
- `stop()`ì€ finalë¡œ ì„ ì–¸ë˜ì–´ ìˆì–´ ì˜¤ë²„ë¼ì´ë”©ì´ ì•ˆë˜ê¸° ë•Œë¬¸ì— `stop2()`ë¡œ ì •ì˜í•´ì•¼ í•œë‹¤.

---

### ë¬¸ì œ 1.3 í´ë˜ìŠ¤ì— ë³„ë„ì˜ í•„ë“œ ì¶”ê°€ ì—†ì´ ìŠ¤ë ˆë“œë¥¼ ì¤‘ë‹¨í•˜ëŠ” ë©”ì„œë“œ ì¶”ê°€
- `interrupt()` ì‚¬ìš©.

<details>
    <summary> Example1_3 </summary>

```java
public class Example1_3 {

    static class Task extends Thread {
        int mils;

        public Task(int mils) {
            this.mils = mils;
        }

        @Override
        public void run() {
            System.out.println("ìŠ¤ë ˆë“œ [ " + Thread.currentThread().getName() + " ]ì„ ì‹œì‘í•©ë‹ˆë‹¤.");

            try {
                while(true) {
                    Thread.sleep(this.mils);
                    System.out.println("ìŠ¤ë ˆë“œ [ " + Thread.currentThread().getName() + " ] ë™ì‘ì¤‘");
                }
            } catch (InterruptedException e) {
                System.out.println("ìŠ¤ë ˆë“œ [ " + Thread.currentThread().getName() + " ]ì—ì„œ ì¸í„°ëŸ½íŠ¸ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
            }

            System.out.println("ìŠ¤ë ˆë“œ [ " + Thread.currentThread().getName() + " ]ì„ ì¢…ë£Œí•©ë‹ˆë‹¤.");
        }

        public void stop2() {
            Thread.currentThread().interrupted();
        }
    }

    public static void main(String[] args) throws InterruptedException {
        Task task = new Task(1000);
        task.start();

        Thread.sleep(5000);
        task.interrupt();
        task.stop2();

        task.join();
    }
}
```

```java
// ì¶œë ¥
ìŠ¤ë ˆë“œ [ Thread-0 ]ì„ ì‹œì‘í•©ë‹ˆë‹¤.
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-0 ]ì„ ì¢…ë£Œí•©ë‹ˆë‹¤.
```

</details>

<br/>

### Comment 
- `run()`ë©”ì„œë“œ ë‚´ì— whileë¬¸ì— ì¡°ê±´ì„ while(!Thread.interrupted()) ì´ëŸ°ì‹ìœ¼ë¡œ ì£¼ë©´ [&#128083;](#ë¬¸ì œ-12-í´ë˜ìŠ¤ì—-í•„ë“œë¥¼-ì¶”ê°€í•´ì„œ-ìŠ¤ë ˆë“œë¥¼-ì¤‘ì§€í•˜ëŠ”-ë©”ì„œë“œ-ì¶”ê°€) (ë¬¸ì œ 1.2)ì˜ stopFlagì˜ ë°©ë²•ê³¼ ë‹¤ë¥¼ê²Œ ì—†ë‹¤.
- while(true) ì´ëŸ° ë°©ë²•ìœ¼ë¡œ ì¡°ê±´ì„ ì¤˜ì•¼í•œë‹¤.
- ë¬´í•œ ë£¨í”„ë¥¼ ëŒë‹¤ê°€ catchë¬¸ìœ¼ë¡œ ë¹ ì ¸ë‚˜ê°€ë„ë¡ ì½”ë“œë¥¼ ì§œì£¼ëŠ” ê²ƒì´ ì™„ë²½í•œ ë°©ë²•ì´ë‹¤.
- ë§ˆì§€ë§‰ `join()`ì„ í•´ì£¼ëŠ” ì´ìœ ëŠ” ë‚˜ë¨¸ì§€ ìŠ¤ë ˆë“œê°€ ëë‚˜ê³  ì œì–´ê¶Œì„ ê°€ì§€ê¸° ìœ„í•´ì„œ ì„ ì–¸í•´ì¤€ë‹¤.

---

### ë¬¸ì œ 2. Runnable ì¸í„°í˜ì´ìŠ¤ í™œìš©
- ë‘ ë²ˆì§¸ ë°©ë²•ì¸ Runnable ì¸í„°í˜ì´ìŠ¤ë¥¼ ì´ìš©.
---

### ë¬¸ì œ 2.1 Runnable ì¸í„°í˜ì´ìŠ¤ë¥¼ ê°€ì§€ê³  í´ë˜ìŠ¤ êµ¬í˜„
- ìƒì„±ëœ í´ë˜ìŠ¤ëŠ” ì¼ì • ì‹œê°„ ê°„ê²©ìœ¼ë¡œ ë©”ì„¸ì§€ë¥¼ ì¶œë ¥.
- ì¼ì • ì‹œê°„ì€ ìƒì„±ìë¥¼ í†µí•´ ìƒì„±ë¨.
- ë©”ì„¸ì§€ ì¶œë ¥ í›„ call stackì„ í™•ì¸.

### Code

<details>
    <summary> Example2_1 </summary>

```java
public class Example2_1 {

    static class Task implements Runnable {
        int mills;
        boolean stopFlag;

        public Task(int mills) {
            this.stopFlag = false;
            this.mills = mills;
        }

        @Override
        public void run() {
            this.stopFlag = false;

            try {
                System.out.println("ìŠ¤ë ˆë“œ [ " + Thread.currentThread().getName() + " ]ì„ ì‹œì‘í•©ë‹ˆë‹¤.");
                while (!this.stopFlag) {
                    Thread.sleep(this.mills);
                    System.out.println("ìŠ¤ë ˆë“œ [ " + Thread.currentThread().getName() + " ] ë™ì‘ì¤‘");
                    Thread.dumpStack();
                }
            } catch (InterruptedException e) {
                System.out.println("ìŠ¤ë ˆë“œ [ " + Thread.currentThread().getName() + " ]ì—ì„œ ì¸í„°ëŸ½íŠ¸ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
            } finally {
                this.stopFlag = false;
            }
            System.out.println("ìŠ¤ë ˆë“œ [ " + Thread.currentThread().getName() + " ]ì„ ì¢…ë£Œí•©ë‹ˆë‹¤.");
        }

        public void stop() {
            this.stopFlag = true;
        }
    }

    public static void main(String[] args) throws InterruptedException {
        Task task = new Task(1000);
        Thread taskThread = new Thread(task);

        taskThread.start();
        Thread.sleep(5000);

        task.stop();
        taskThread.join();
    }
}
```

```java
// ì¶œë ¥
ìŠ¤ë ˆë“œ [ Thread-0 ]ì„ ì‹œì‘í•©ë‹ˆë‹¤.
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
java.lang.Exception: Stack trace
	at java.base/java.lang.Thread.dumpStack(Thread.java:1387)
	at Example2_1$Task.run(Example2_1.java:22)
	at java.base/java.lang.Thread.run(Thread.java:834)
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
java.lang.Exception: Stack trace
	at java.base/java.lang.Thread.dumpStack(Thread.java:1387)
	at Example2_1$Task.run(Example2_1.java:22)
	at java.base/java.lang.Thread.run(Thread.java:834)
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
java.lang.Exception: Stack trace
	at java.base/java.lang.Thread.dumpStack(Thread.java:1387)
	at Example2_1$Task.run(Example2_1.java:22)
	at java.base/java.lang.Thread.run(Thread.java:834)
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
java.lang.Exception: Stack trace
	at java.base/java.lang.Thread.dumpStack(Thread.java:1387)
	at Example2_1$Task.run(Example2_1.java:22)
	at java.base/java.lang.Thread.run(Thread.java:834)
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-0 ]ì„ ì¢…ë£Œí•©ë‹ˆë‹¤.
java.lang.Exception: Stack trace
	at java.base/java.lang.Thread.dumpStack(Thread.java:1387)
	at Example2_1$Task.run(Example2_1.java:22)
	at java.base/java.lang.Thread.run(Thread.java:834)
```

</details>

<br/>

### Comment
- Runnable ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©´ ìŠ¤ë ˆë“œë¥¼ ìƒì„±í•  ì‹œ ë‘ë²ˆì˜ ê³¼ì •ì„ ê±°ì³ì•¼ í•˜ëŠ” ë¶ˆí¸í•œì ì´ ìˆë‹¤.

    ```java
    Task task = new Task(1000);
    Thread taskThread = new Thread(task);
    ```

---

### ë¬¸ì œ 2.2 Runnable ì¸í„°í˜ì´ìŠ¤ë¥¼ ì´ìš©í•´ Thread í´ë˜ìŠ¤ ìƒì†ê³¼ ê°™ì´ êµ¬í˜„
- Runnable ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ì—¬ Threadì˜ ë©”ì¸ì„ êµ¬ì„±.
- ì¼ë°˜ì ìœ¼ë¡œ Runnable ì¸í„°í˜ì´ìŠ¤ë¥¼ ì´ìš©í•  ê²½ìš°, ë³„ë„ì˜ Thread ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ì´ë¥¼ í†µí•´ ì‹¤í–‰ ì‹œí‚´.
- êµ¬í˜„ëœ í´ë˜ìŠ¤ì—ì„œ ìƒì„±í•œ ê°ì²´ì—ì„œ ì§ì ‘ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ í´ë˜ìŠ¤ë¥¼ ì •ì˜.

### Code

<details>
    <summary> Example2_2 </summary>

```java
public class Example2_2 {

    static class Task implements Runnable {
        int mills;
        Thread thread;

        public Task(int mills) {
            this.mills = mills;
        }

        @Override
        public void run() {
            try {
                System.out.println("ìŠ¤ë ˆë“œ [ " + Thread.currentThread().getName() + " ]ì„ ì‹œì‘í•©ë‹ˆë‹¤.");
                while (true) {
                    Thread.sleep(this.mills);
                    System.out.println("ìŠ¤ë ˆë“œ [ " + Thread.currentThread().getName() + " ] ë™ì‘ì¤‘");
                }
            } catch (InterruptedException e) {
                System.out.println("ìŠ¤ë ˆë“œ [ " + Thread.currentThread().getName() + " ]ì—ì„œ ì¸í„°ëŸ½íŠ¸ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
            }

            System.out.println("ìŠ¤ë ˆë“œ [ " + Thread.currentThread().getName() + " ]ì„ ì¢…ë£Œí•©ë‹ˆë‹¤.");
            this.thread = null;
        }

        public void start() {
            this.thread = new Thread(this);
            this.thread.start();
        }

        public void stop() {
            this.thread.interrupt();
        }

        public void join() throws InterruptedException {
            this.thread.join();
        }
    }

    public static void main(String[] args) throws InterruptedException {
        Task task = new Task(1000);

        task.start();
        Thread.sleep(5000);
        task.stop();
        task.join();
    }
}
```

```java
// ì¶œë ¥
ìŠ¤ë ˆë“œ [ Thread-0 ]ì„ ì‹œì‘í•©ë‹ˆë‹¤.
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-0 ]ì—ì„œ ì¸í„°ëŸ½íŠ¸ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.
ìŠ¤ë ˆë“œ [ Thread-0 ]ì„ ì¢…ë£Œí•©ë‹ˆë‹¤.
```
</details>

<br/>

### Comment
- Task í´ë˜ìŠ¤ ì•ˆì— Thread í•„ë“œë¥¼ ë§Œë“¤ê³  `start()`, `join()`, `stop()`ë©”ì„œë“œì— thread ë©”ì„œë“œë¥¼ êµ¬í˜„ í•´ì£¼ë©´ ë¨.




---
### ë¬¸ì œ 3. ë°ëª¬ì„ ë§Œë“¤ê¸°
---

### ë¬¸ì œ 3.1 ìŠ¤ë ˆë“œ ì•ˆì—ì„œ ìŠ¤ë ˆë“œ ë§Œë“¤ê¸°
- Taskì—ì„œ ë‘ ê°œì˜ ì£¼ê¸°ë¥¼ ë°›ì•„ ìŠ¤ë ˆë“œ ë‚´ì—ì„œ ìŠ¤ë ˆë“œë¥¼ ì¶”ê°€ ìƒì„±.

### Code

<details>
    <summary> Example3_1 </summary>

```java
public class Example3_1 {

    static class Task implements Runnable {
        Thread thread;
        long interval;
        boolean stopFlag;
        Task childTask;

        public Task(long interval) {
            this.stopFlag = true;
            this.interval = interval;
            this.thread = new Thread(this);
        }

        public Task(long interval, long childInterval) {
            this.stopFlag = true;
            this.interval = interval;
            this.thread = new Thread(this);
            if (childInterval != 0) {
                this.childTask = new Task(childInterval);
            }
        }

        public void start() {
            this.thread.start();
        }

        public boolean isStop() {
            return this.stopFlag == true;
        }

        public long getInterval() {
            return this.interval;
        }

        public void stop() {
            this.stopFlag = true;
        }

        public void join() throws InterruptedException {
            this.thread.join();
        }

        @Override
        public void run() {
            if (this.childTask != null) {
                this.childTask.start();
            }

            this.stopFlag = false;
            System.out.println("ìŠ¤ë ˆë“œ [ " + Thread.currentThread().getName() + " ]ì„ ì‹œì‘í•©ë‹ˆë‹¤.");

            while (!this.isStop()) {
                try {
                    Thread.sleep(this.getInterval());
                    System.out.println("ìŠ¤ë ˆë“œ [ " + Thread.currentThread().getName() + " ] ë™ì‘ì¤‘");
                } catch (InterruptedException e) {
                }
            }

            System.out.println("ìŠ¤ë ˆë“œ [ " + Thread.currentThread().getName() + " ]ì„ ì¢…ë£Œí•©ë‹ˆë‹¤.");
        }
    }

    public static void main(String[] args) throws InterruptedException {
        Task task = new Task(2000, 1000);

        task.start();

        Thread.sleep(10000);

        task.stop();

        task.join();
    }
}
```

```java
// ì¶œë ¥
ìŠ¤ë ˆë“œ [ Thread-0 ]ì„ ì‹œì‘í•©ë‹ˆë‹¤.
ìŠ¤ë ˆë“œ [ Thread-1 ]ì„ ì‹œì‘í•©ë‹ˆë‹¤.
ìŠ¤ë ˆë“œ [ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-0 ]ì„ ì¢…ë£Œí•©ë‹ˆë‹¤.
ìŠ¤ë ˆë“œ [ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-1 ] ë™ì‘ì¤‘
```

</details>

<br/>

### Comment
- Thread-0ë§Œ ì‚¬ë¼ì§€ê³  joinë˜ê³  ìˆë‹¤.
- ë¬¸ì œì  : Thread-1ì´ ê³„ì† ì‘ë™ì¤‘ì´ë‹¤.

---

### ë¬¸ì œ 3.2 ìŠ¤ë ˆë“œ ë‚´ë¶€ì—ì„œ ìƒì„±ëœ ìŠ¤ë ˆë“œê°€ ì¢…ë£Œë˜ë„ë¡ ìˆ˜ì •
- [&#128083;](#ë¬¸ì œ-31-ìŠ¤ë ˆë“œ-ì•ˆì—ì„œ-ìŠ¤ë ˆë“œ-ë§Œë“¤ê¸°) ë¬¸ì œ 3.1ì—ì„œ ë°œìƒí•œ ë¬¸ì œì  ìˆ˜ì •.

### Code
<details>
    <summary> Example3_2 </summary>

```java
public class Example3_2 {

    static class Task implements Runnable {
        Thread thread;
        long interval;
        boolean stopFlag;
        Task childTask;

        public Task(long interval) {
            this.stopFlag = true;
            this.interval = interval;
            this.thread = new Thread(this);
        }

        public Task(long interval, long childInterval) {
            this.stopFlag = true;
            this.interval = interval;
            this.thread = new Thread(this);
            if (childInterval != 0) {
                this.childTask = new Task(childInterval);
            }
        }

        public void start() {
            this.thread.start();
        }

        public boolean isStop() {
            return this.stopFlag == true;
        }

        public long getInterval() {
            return this.interval;
        }

        public void stop() {
            this.stopFlag = true;
        }

        public void join() throws InterruptedException {
            this.thread.join();
        }

        @Override
        public void run() {
            if(this.childTask != null) {
                this.childTask.start();
            }

            this.stopFlag = false;
            System.out.println("ìŠ¤ë ˆë“œ [ " + Thread.currentThread().getName() + " ]ì„ ì‹œì‘í•©ë‹ˆë‹¤.");

            while (!this.isStop()) {
                try {
                    Thread.sleep(this.getInterval());
                    System.out.println("ìŠ¤ë ˆë“œ [ " + Thread.currentThread().getName() + " ] ë™ì‘ì¤‘");
                } catch (InterruptedException e) {
                }
            }

            if(this.childTask != null) {
                this.childTask.stop();
            }

            System.out.println("ìŠ¤ë ˆë“œ [ " + Thread.currentThread().getName() + " ]ì„ ì¢…ë£Œí•©ë‹ˆë‹¤.");
        }
    }

    public static void main(String[] args) throws InterruptedException {
        Task task = new Task(2000, 1000);

        task.start();

        Thread.sleep(10000);

        task.stop();

        task.join();
    }
}
```

```java
// ì¶œë ¥
ìŠ¤ë ˆë“œ [ Thread-1 ]ì„ ì‹œì‘í•©ë‹ˆë‹¤.
ìŠ¤ë ˆë“œ [ Thread-0 ]ì„ ì‹œì‘í•©ë‹ˆë‹¤.
ìŠ¤ë ˆë“œ [ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-0 ]ì„ ì¢…ë£Œí•©ë‹ˆë‹¤.
ìŠ¤ë ˆë“œ [ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ [ Thread-1 ]ì„ ì¢…ë£Œí•©ë‹ˆë‹¤.
```

</details>

<br/>

### Comment
- Thread-0ì´ ì¢…ë£Œë˜ê³  ë‚˜ë©´ Thread-1ë„ ê°™ì´ ì¢…ë£Œëœë‹¤.
- ```java
  // run()ë©”ì„œë“œ ì•ˆì— ì¢…ë£Œ ë˜ê¸°ì „ì— childë„ ê°™ì´ ì¢…ë£Œë¥¼ ì‹œì¼œì¤Œ
  if(this.childTask != null) {
    this.childTask.stop();
  }
  ```
---

### ë¬¸ì œ 3.3 ìŠ¤ë ˆë“œ ë‚´ë¶€ì—ì„œ ìƒì„±ëœ ìŠ¤ë ˆë“œë¥¼ ë°ëª¬ìœ¼ë¡œ ìƒì„±.
- Taskì—ì„œ ë‘ê°œì˜ ì£¼ê¸°ë¥¼ ë°›ì•„ ìŠ¤ë ˆë“œ ë‚´ì—ì„œ ìŠ¤ë ˆë“œë¥¼ ì¶”ê°€ë¡œ ì‹¤í–‰.

### Code

<details>
    <summary> Example3_3 </summary>

```java
public class Example3_3 {

    static class Task implements Runnable {
        Thread  thread;
        boolean stopFlag;
        long interval;
        Task childTask;
        public Task(long interval) {
            this.stopFlag = true;
            this.interval = interval;
            this.thread = new Thread(this);
        }

        public Task(long interval, long childInterval) {
            this.stopFlag = true;
            this.interval = interval;
            this.thread = new Thread(this);
            if (childInterval != 0) {
                this.childTask = new Task(childInterval);
                this.childTask.setDaemon(true);
            }
        }

        public void start() {
            this.thread.start();
        }

        public void stop() {
            this.stopFlag = true;
        }

        public boolean isStop() {
            return  this.stopFlag == true;
        }

        public long getInterval() {
            return  this.interval;
        }

        public void setDaemon(boolean on) {
            this.thread.setDaemon(on);
        }

        public void join() throws InterruptedException {
            this.thread.join();
        }
        @Override
        public void run() {
            if (this.childTask != null) {
                this.childTask.start();
            }
            this.stopFlag = false;
            System.out.println("ìŠ¤ë ˆë“œ[ " + Thread.currentThread().getName() + " ]ì„ ì‹œì‘ í•©ë‹ˆë‹¤");
            while(!this.isStop()) {
                try {
                    Thread.sleep(this.getInterval());
                    System.out.println("ìŠ¤ë ˆë“œ[ " + Thread.currentThread().getName() + " ] ë™ì‘ì¤‘");
                } catch (InterruptedException ignore) {
                }
            }
            System.out.println("ìŠ¤ë ˆë“œ[ " + Thread.currentThread().getName() + " ]ì„ ì¢…ë£Œ í•©ë‹ˆë‹¤");
        }
    }

    public static void main(String [] args) throws InterruptedException {
        Task task = new Task(2000, 1000);

        task.start();

        Thread.sleep(10000);

        task.stop();

        task.join();
    }
}
```

```java
// ì¶œë ¥
ìŠ¤ë ˆë“œ[ Thread-1 ]ì„ ì‹œì‘ í•©ë‹ˆë‹¤
ìŠ¤ë ˆë“œ[ Thread-0 ]ì„ ì‹œì‘ í•©ë‹ˆë‹¤
ìŠ¤ë ˆë“œ[ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ[ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ[ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ[ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ[ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ[ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ[ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ[ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ[ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ[ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ[ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ[ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ[ Thread-1 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ[ Thread-0 ] ë™ì‘ì¤‘
ìŠ¤ë ˆë“œ[ Thread-0 ]ì„ ì¢…ë£Œ í•©ë‹ˆë‹¤
```
</details>

<br/>

### Comment
- ìì‹ ìŠ¤ë ˆë“œë¥¼ ë°ëª¬ ì“°ë ˆë“œë¡œ ì§€ì •.
- ```java
  this.childTask.setDaemon(true);
  ```
- ê¸°ì¡´ ëª¨ë“  ì“°ë ˆë“œê°€ ì¢…ë£Œë˜ë©´ ë°ëª¬ ì“°ë ˆë“œë„ ê°™ì´ ì¢…ë£Œëœë‹¤.


---
### ë¬¸ì œ 4. ì¸í„°ëŸ½íŠ¸ë¡œ ì¸í•œ ë™ì‘ ë³€í™”ë¥¼ ìˆ˜ì •
---
### ë¬¸ì œ 4.1 Busy waitingìœ¼ë¡œ ëŒ€ê¸°
- ë©”ì‹œì§€ ì¶œë ¥ ëŒ€ê¸°ë¥¼ busy waitingìœ¼ë¡œ êµ¬í˜„.
- ë©”ì¸ ìŠ¤ë ˆë“œë‚´ì—ì„œ ë‘ê°œì˜ ê°ì²´ê°€ ë™ì‘í•˜ëŠ” ì‹œê°„ ê°„ê²© ë³´ë‹¤ ì§§ê²Œí•˜ì—¬ ì¸í„°ëŸ½íŠ¸ë¥¼ ìƒì„±.

### Code

<details>
    <summary> Example4_1 </summary>

```java
public class Example4_1 {

    static class Task extends Thread {
        int interval;

        public Task(int interval) {
            this.interval = interval;
        }

        public int getInterval() {
            return interval;
        }

        @Override
        public void run() {
            long startTime = System.currentTimeMillis();
            long previousPrintTime = 0;
            long targetTime = startTime + this.interval;

            while (true) {
                while (System.currentTimeMillis() < targetTime) {
                }

                long totalElapsedTime = System.currentTimeMillis() - startTime;
                long elapsedTime = totalElapsedTime - previousPrintTime;
                System.out.printf("[ %02d:%02d.%03d ][ %02d.%03d ] %s \n",
                        totalElapsedTime / (60 * 1000), (totalElapsedTime / 1000) % 60, totalElapsedTime,
                        (elapsedTime / 1000), elapsedTime % 1000,
                        Thread.currentThread().getName());

                previousPrintTime = totalElapsedTime;
                targetTime = targetTime + this.interval;

            }
        }
    }

    public static void main(String[] args) throws InterruptedException {
        Task task1 = new Task(3000);
        Task task2 = new Task(5000);
        task1.start();
        task2.start();

        long    startTime = System.currentTimeMillis();
        long    previousPrintTime = 0;

        for(int i = 0 ; i < 100 ; i++) {
            Thread.sleep(1000);
            if (i % 2 == 0) {
                task1.interrupt();
                task2.interrupt();

            }

            long totalElapsedTime = System.currentTimeMillis() - startTime;
            long elapsedTime = totalElapsedTime - previousPrintTime;
            System.out.printf("[ %02d:%02d.%03d ][ %02d.%03d ] %s - %s\n",
                    totalElapsedTime / (60 * 1000), (totalElapsedTime / 1000) % 60, totalElapsedTime % 1000,
                    (elapsedTime / 1000), elapsedTime % 1000, task1.getState(), task2.getState());
            previousPrintTime = totalElapsedTime;
        }

    }
}
```

```java
// ì¶œë ¥
[ 00:01.006 ][ 01.006 ] RUNNABLE - RUNNABLE
[ 00:02.032 ][ 01.026 ] RUNNABLE - RUNNABLE
[ 00:03.3000 ][ 03.000 ] Thread-0 
[ 00:03.034 ][ 01.002 ] RUNNABLE - RUNNABLE
[ 00:04.039 ][ 01.005 ] RUNNABLE - RUNNABLE
[ 00:05.5000 ][ 05.000 ] Thread-1 
[ 00:05.045 ][ 01.006 ] RUNNABLE - RUNNABLE
[ 00:06.6000 ][ 03.000 ] Thread-0 
[ 00:06.050 ][ 01.005 ] RUNNABLE - RUNNABLE
[ 00:07.057 ][ 01.007 ] RUNNABLE - RUNNABLE
[ 00:08.062 ][ 01.005 ] RUNNABLE - RUNNABLE
[ 00:09.9000 ][ 03.000 ] Thread-0 
[ 00:09.069 ][ 01.007 ] RUNNABLE - RUNNABLE
[ 00:10.10000 ][ 05.000 ] Thread-1 
[ 00:10.075 ][ 01.006 ] RUNNABLE - RUNNABLE
[ 00:11.081 ][ 01.006 ] RUNNABLE - RUNNABLE
[ 00:12.12000 ][ 03.000 ] Thread-0 
[ 00:12.088 ][ 01.007 ] RUNNABLE - RUNNABLE
[ 00:13.093 ][ 01.005 ] RUNNABLE - RUNNABLE
[ 00:14.100 ][ 01.007 ] RUNNABLE - RUNNABLE
[ 00:15.15000 ][ 05.000 ] Thread-1 
[ 00:15.15000 ][ 03.000 ] Thread-0 
```

</details> 

<br/>

### Commnet
- ì¸í„°ëŸ½íŠ¸ë¥¼ ì¤˜ë„ ë³€í™”ê°€ ìƒê¸°ì§€ ì•Šì•˜ë‹¤.
- ì¸í„°ëŸ½íŠ¸ ì¡°ê±´ì´ ë§ì§€ ì•Šê¸°ì— ë³€í™”ê°€ X -> ì•„ë¬´ì¼ì´ ì¼ì–´ë‚˜ì§€ ì•ŠëŠ” ê²ƒì´ ë¬¸ì œ!

---

### ë¬¸ì œ 4.2 Thread.sleep() ë©”ì„œë“œë¥¼ ì´ìš©
- ë©”ì¸ ìŠ¤ë ˆë“œ ë‚´ì—ì„œ ë‘ê°œì˜ ê°ì²´ê°€ ë™ì‘í•˜ëŠ” ì‹œê°„ ê°„ê²© ë³´ë‹¤ ì§§ê²Œí•˜ì—¬ ì¸í„°ëŸ½íŠ¸ ìƒì„±.

### Code

<details>
    <summary> Example4_2 </summary>

```java
public class Example4_2 {

    static class Task extends Thread {
        int interval;

        public Task(int interval) {
            this.interval = interval;
        }

        public int getInterval() {
            return interval;
        }

        @Override
        public void run() {
            long startTime = System.currentTimeMillis();
            long previousPrintTime = 0;
            long targetTime = startTime + this.interval;

            while (true) {
                while (System.currentTimeMillis() < targetTime) {
                }

                try {
                    Thread.sleep(this.interval);
                    long totalElapsedTime = System.currentTimeMillis() - startTime;
                    long elapsedTime = totalElapsedTime - previousPrintTime;
                    System.out.printf("[ %02d:%02d.%03d ][ %02d.%03d ] %s \n",
                            totalElapsedTime / (60 * 1000), (totalElapsedTime / 1000) % 60, totalElapsedTime,
                            (elapsedTime / 1000), elapsedTime % 1000,
                            Thread.currentThread().getName());

                    previousPrintTime = totalElapsedTime;
                    targetTime = targetTime + this.interval;
                } catch (InterruptedException e) {
                }

            }
        }
    }

    public static void main(String[] args) throws InterruptedException {
        Task task1 = new Task(3000);
        Task task2 = new Task(5000);
        task1.start();
        task2.start();

        long    startTime = System.currentTimeMillis();
        long    previousPrintTime = 0;

        for(int i = 0 ; i < 100 ; i++) {
            Thread.sleep(1000);
            if (i % 2 == 0) {
                task1.interrupt();
                task2.interrupt();
            }

            long totalElapsedTime = System.currentTimeMillis() - startTime;
            long elapsedTime = totalElapsedTime - previousPrintTime;
            System.out.printf("[ %02d:%02d.%03d ][ %02d.%03d ] %s - %s\n",
                    totalElapsedTime / (60 * 1000), (totalElapsedTime / 1000) % 60, totalElapsedTime % 1000,
                    (elapsedTime / 1000), elapsedTime % 1000, task1.getState(), task2.getState());
            previousPrintTime = totalElapsedTime;
        }

    }
}
```

```java
// ì¶œë ¥
[ 00:01.005 ][ 01.005 ] RUNNABLE - RUNNABLE
[ 00:02.030 ][ 01.025 ] RUNNABLE - RUNNABLE
[ 00:03.035 ][ 01.005 ] TIMED_WAITING - RUNNABLE
[ 00:04.041 ][ 01.006 ] TIMED_WAITING - RUNNABLE
[ 00:05.047 ][ 01.006 ] TIMED_WAITING - TIMED_WAITING
[ 00:06.053 ][ 01.006 ] TIMED_WAITING - TIMED_WAITING
[ 00:07.064 ][ 01.011 ] TIMED_WAITING - TIMED_WAITING
[ 00:08.073 ][ 01.009 ] TIMED_WAITING - TIMED_WAITING
[ 00:09.083 ][ 01.010 ] TIMED_WAITING - TIMED_WAITING
```

</details>

<br/>

### Comment 
- [&#128083;](#ë¬¸ì œ-41-busy-waitingìœ¼ë¡œ-ëŒ€ê¸°) ë¬¸ì œ 4.1 ì½”ë“œì™€ ê±°ì˜ ë¹„ìŠ·í•˜ì§€ë§Œ ì¸í„°ëŸ½íŠ¸ê°€ ë°œìƒí–ˆë‹¤.

---

### ë¬¸ì œ 4.3 ì•ˆí„°ëŸ½íŠ¸ë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” ë¬¸ì œ í•´ê²°
- ìˆ˜ì •í•˜ì—¬ ì •í•´ì§„ ì‹œê°„ ê°„ê²©ì— ë§ë„ë¡ ë©”ì‹œì§€ê°€ ì¶œë ¥ë˜ë„ë¡ ìˆ˜ì •. (ë©”ì‹œì§€ ì¶œë ¥ ì‹œê°„ ê°„ê²©ì˜ ì˜¤ì°¨ëŠ” ì¼ë¶€ ë°œìƒ, ë°€ë¦¼ í˜„ìƒì€ ë°œìƒí•˜ì§€ ì•Šê²Œ)
- ìŠ¤ë ˆë“œ ë™ì‘ ìƒíƒœë¥¼ í™•ì¸.

### Code

<details>
    <summary> Example4_3 </summary>

```java
public class Example4_3 {

    static class Task extends Thread {
        int interval;

        public Task(int interval) {
            this.interval = interval;
        }

        public int getInterval() {
            return interval;
        }

        @Override
        public void run() {
            long startTime = System.currentTimeMillis();
            long previousPrintTime = 0;

            while (true) {
                try {
                    Thread.sleep(this.interval - (System.currentTimeMillis() - startTime) % this.interval);
                    long totalElapsedTime = System.currentTimeMillis() - startTime;
                    long elapsedTime = totalElapsedTime - previousPrintTime;
                    System.out.printf("[ %02d:%02d.%03d ][ %02d.%03d ] %s \n",
                            totalElapsedTime / (60 * 1000), (totalElapsedTime / 1000) % 60, totalElapsedTime,
                            (elapsedTime / 1000), elapsedTime % 1000,
                            Thread.currentThread().getName());

                    previousPrintTime = totalElapsedTime;
                } catch (InterruptedException e) {
                }
            }
        }
    }

    public static void main(String[] args) throws InterruptedException {
        Task task1 = new Task(3000);
        Task task2 = new Task(5000);
        task1.start();
        task2.start();

        long    startTime = System.currentTimeMillis();
        long    previousPrintTime = 0;

        for(int i = 0 ; i < 100 ; i++) {
            Thread.sleep(1000);
            if (i % 2 == 0) {
                task1.interrupt();
                task2.interrupt();
            }

            long totalElapsedTime = System.currentTimeMillis() - startTime;
            long elapsedTime = totalElapsedTime - previousPrintTime;
            System.out.printf("[ %02d:%02d.%03d ][ %02d.%03d ] %s - %s\n",
                    totalElapsedTime / (60 * 1000), (totalElapsedTime / 1000) % 60, totalElapsedTime % 1000,
                    (elapsedTime / 1000), elapsedTime % 1000, task1.getState(), task2.getState());
            previousPrintTime = totalElapsedTime;
        }

    }
}
```

```java
// ì¶œë ¥
[ 00:01.002 ][ 01.002 ] TIMED_WAITING - TIMED_WAITING
[ 00:02.023 ][ 01.021 ] TIMED_WAITING - TIMED_WAITING
[ 00:03.3005 ][ 03.005 ] Thread-0 
[ 00:03.028 ][ 01.005 ] TIMED_WAITING - TIMED_WAITING
[ 00:04.035 ][ 01.007 ] TIMED_WAITING - TIMED_WAITING
[ 00:05.5005 ][ 05.005 ] Thread-1 
[ 00:05.039 ][ 01.004 ] TIMED_WAITING - TIMED_WAITING
[ 00:06.6001 ][ 02.996 ] Thread-0 
[ 00:06.043 ][ 01.004 ] TIMED_WAITING - TIMED_WAITING
[ 00:07.051 ][ 01.008 ] TIMED_WAITING - TIMED_WAITING
[ 00:08.060 ][ 01.009 ] TIMED_WAITING - TIMED_WAITING
```

</details>

<br/>

### Comment
- [&#128083;](#ë¬¸ì œ-41-busy-waitingìœ¼ë¡œ-ëŒ€ê¸°) ë¬¸ì œ 4.1 ì½”ë“œì™€ ê±°ì˜ ë¹„ìŠ·í•˜ì§€ë§Œ ì •í•´ì§„ ì‹œê°„ ê°„ê²©ì— ë§ê²Œ ë©”ì‹œì§€ê°€ ì¶œë ¥ì´ ë¨.
- Thread.sleep() ì½”ë“œê°€ ë³€ê²½ë¨.
- Threadë¥¼ ì¶”ì í•˜ëŠ” ë°©ë²• ì¤‘ í•˜ë‚˜ë¡œ print()ë¥¼ ë§ì´ ì°ì–´ë³´ëŠ” ê²ƒì´ë‹¤.
- Threadë¥¼ ì²˜ìŒë¶€í„° ì™„ì „í•˜ê²Œ ì´í•´í•˜ëŠ” ê²ƒì€ ë§¤ìš° ì–´ë µë‹¤ê³  í•˜ë‹ˆ ì‹¤ìˆ˜ë¥¼ í†µí•´ ìì—°ìŠ¤ëŸ½ê²Œ ìŠµë“í•˜ëŠ” ê²ƒì´ë¼ê³  í•œë‹¤.


---
### ë¬¸ì œ 5. ë‘ê°œì˜ ê°ì²´ë¥¼ ë™ê¸°í™”
- ë‘ê°œì˜ ê°ì²´ëŠ” ë‹¤ë¥¸ ê°ì²´ì— ì˜í–¥ì„ ë°›ì§€ ì•Šê³  ë™ì‘í•´ì•¼ í•¨.
- ë‘ê°œì˜ ê°ì²´ê°€ ë©”ì‹œì§€ ì¶œë ¥ì— ìƒí˜¸ ì˜í–¥ ë°›ë„ë¡ ìˆ˜ì •.
---
### ë¬¸ì œ 5.1 Lockì„ ì´ìš©í•´ ë™ê¸°í™”
- java.util.concurrent.locks ì´ìš©.
- ì˜ˆë¥¼ ë“¤ì–´) ì²« ê°ì²´ê°€ ì¶œë ¥í•˜ê³ , ë‘ë²ˆì¨° ê°ì²´ê°€ ì¶œë ¥ëœë‹¤ë©´ ë‘ ì¶œë ¥ê°„ì˜ ì‹œê°„ ê°„ê²©ì€ ì²« ê°ì²´ì— ì„¤ì •ëœ ì‹œê°„ ê°„ê²©ì´ ë˜ì–´ì•¼ í•¨.
- ì²« ê°ì²´ê°€ ì¶œë ¥ëœ í›„ ë‹¤ìŒ ê°ì²´ëŠ” ì²«ë²ˆì§¸ í˜¹ì€ ë‘ë²ˆì¨° ë‘˜ ë‹¤ ê°€ëŠ¥.
- ìŠ¤ë ˆë“œ ë™ì‘ ìƒíƒœë¥¼ í™•ì¸

### Code

<details>
    <summary> Example5_1 </summary>

```java
import java.util.concurrent.locks.ReentrantLock;

public class Example5_1 {

    static class Task extends Thread{
        long interval;
        static ReentrantLock lock;

        public Task(long interval) {
            this.interval = interval;
            this.lock = new ReentrantLock();
        }

        @Override
        public void run() {
            long startTime = System.currentTimeMillis();
            long previousPrintTime = 0;

            while (true) {
                try {
                    lock.lock();
                    Thread.sleep(this.interval);
                    long totalElapsedTime = System.currentTimeMillis() - startTime;
                    long elapsedTime = totalElapsedTime - previousPrintTime;
                    System.out.printf("[ %02d:%02d.%03d ][ %02d.%03d ] %s \n",
                            totalElapsedTime / (60 * 1000), (totalElapsedTime / 1000) % 60, totalElapsedTime,
                            (elapsedTime / 1000), elapsedTime % 1000,
                            Thread.currentThread().getName());

                    previousPrintTime = totalElapsedTime;

                    lock.unlock();
                    Thread.yield();
                } catch (InterruptedException e) {
                }

            }

        }
    }

    public static void main(String[] args) throws InterruptedException {
        Task task1 = new Task(3000);
        Task task2 = new Task(5000);

        task1.start();
        task2.start();

        task1.join();
    }
}
```

```java
// static ì—†ëŠ” ìƒíƒœì˜ ì¶œë ¥
[ 00:03.3008 ][ 03.008 ] Thread-0 
[ 00:05.5008 ][ 05.008 ] Thread-1 
[ 00:06.6039 ][ 03.031 ] Thread-0 
[ 00:09.9043 ][ 03.004 ] Thread-0 
[ 00:10.10016 ][ 05.008 ] Thread-1 
[ 00:12.12050 ][ 03.007 ] Thread-0 
[ 00:15.15022 ][ 05.006 ] Thread-1 
[ 00:15.15055 ][ 03.005 ] Thread-0 
[ 00:18.18063 ][ 03.008 ] Thread-0 
[ 00:20.20032 ][ 05.010 ] Thread-1 
[ 00:21.21069 ][ 03.006 ] Thread-0 

// static ìˆëŠ” ìƒíƒœì˜ ì¶œë ¥
[ 00:03.3009 ][ 03.009 ] Thread-0 
[ 00:06.6045 ][ 03.036 ] Thread-0 
[ 00:09.9051 ][ 03.006 ] Thread-0 
[ 00:12.12058 ][ 03.007 ] Thread-0 
[ 00:17.17068 ][ 17.068 ] Thread-1 
[ 00:20.20075 ][ 08.017 ] Thread-0 
[ 00:25.25082 ][ 08.014 ] Thread-1 
[ 00:28.28089 ][ 08.014 ] Thread-0 
[ 00:33.33098 ][ 08.016 ] Thread-1 
[ 00:38.38106 ][ 05.008 ] Thread-1 
```
</details>

<br/>

### Comment
- Task class í•„ë“œì— **static**ì˜ ìœ ë¬´ ì°¨ì´ê°€ ìˆë‹¤. (*ì¶œë ¥ ê²°ê³¼ì—ì„œ ì°¨ì´*)
- **static**ì´ ì—†ëŠ” ê²½ìš°ì— ì¶œë ¥ ê²°ê³¼ë¥¼ ë³´ë©´ lockì´ ì•ˆë˜ê³  ìˆë‹¤. lockì´ ì•ˆë˜ê³  ìˆëŠ” ì´ìœ ëŠ” lockì€ ë¬´ì¡°ê±´ **ê³µìœ **ë˜ì–´ì•¼ í•œë‹¤.
- ì •ìƒì ì¸ ì¶œë ¥ ê²°ê³¼ë¥¼ ë³´ë©´ ê°ì²´ë“¤ì˜ ì‹œê°„ ì°¨ì´ë¥¼ ë³´ë©´ ê°ì²´ë¡œ ì¤¬ë˜ 3ì´ˆ, 5ì´ˆ ì°¨ì´ê°€ ë‚˜ëŠ” ê²ƒì„ ë³´ì—¬ì¤€ë‹¤. (Lockì´ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰)


---
### ë¬¸ì œ 5.2 synchronized í‚¤ì›Œë“œì™€ ì •ì  ë©”ì†Œë“œë¥¼ ì´ìš©í•´ ë™ê¸°í™” ì‹œí‚¤ê¸°
- synchronized ì‚¬ìš©.

### Code

<details>
    <summary> Example5_2 </summary>

```java
public class Example5_2 {

    static class Task extends Thread {
        long interval;
        boolean stopFlag;

        public Task(long interval) {
            this.interval = interval;
            this.stopFlag = true;
        }

        public void stop2() {
            this.stopFlag = true;
        }

        public boolean isStop() {
            return this.stopFlag;
        }

        static synchronized void print(long interval) throws InterruptedException {
            Thread.sleep(interval);
        }

        @Override
        public void run() {
            long startTime = System.currentTimeMillis();
            long previousPrintTime = 0;
            this.stopFlag = false;

            while (!this.isStop()) {
                try {
                    long totalElapsedTime = System.currentTimeMillis() - startTime;
                    long elapsedTime = totalElapsedTime - previousPrintTime;
                    System.out.printf("[ %02d:%02d.%03d ][ %02d.%03d ] %s \n",
                            totalElapsedTime / (60 * 1000), (totalElapsedTime / 1000) % 60, totalElapsedTime,
                            (elapsedTime / 1000), elapsedTime % 1000,
                            Thread.currentThread().getName());

                    print(this.interval);
                    previousPrintTime = totalElapsedTime;
                } catch (InterruptedException e) {
                }
            }
        }
    }

    public static void main(String[] args) throws InterruptedException {
        Task task1 = new Task(3000);
        Task task2 = new Task(5000);

        task1.start();
        task2.start();

        long    startTime = System.currentTimeMillis();
        long    previousPrintTime = 0;

        for(int i = 0 ; i < 100 ; i++) {
            Thread.sleep(1000);
            if (i % 2 == 0) {
                task1.interrupt();
                task2.interrupt();
            }
            long totalElapsedTime = System.currentTimeMillis() - startTime;
            long elapsedTime = totalElapsedTime - previousPrintTime;
            System.out.printf("[ %02d:%02d.%03d ][ %02d.%03d ] %s - %s\n",
                    totalElapsedTime / (60 * 1000), (totalElapsedTime / 1000) % 60,
                    totalElapsedTime % 1000,
                    (elapsedTime / 1000), elapsedTime % 1000,
                    task1.getState(), task2.getState());
            previousPrintTime = totalElapsedTime;
        }

        task1.stop2();
        task2.stop2();
    }
}
```

```java
// ì¶œë ¥
[ 00:00.000 ][ 00.000 ] Thread-0 
[ 00:00.000 ][ 00.000 ] Thread-1 
[ 00:01.001 ][ 01.001 ] TIMED_WAITING - BLOCKED
[ 00:01.1001 ][ 01.001 ] Thread-1 
[ 00:01.1001 ][ 01.001 ] Thread-0 
[ 00:02.007 ][ 01.006 ] BLOCKED - TIMED_WAITING
[ 00:03.013 ][ 01.006 ] BLOCKED - TIMED_WAITING
[ 00:03.3013 ][ 03.013 ] Thread-0 
[ 00:03.3013 ][ 03.013 ] Thread-1 
[ 00:04.024 ][ 01.011 ] TIMED_WAITING - BLOCKED
[ 00:05.036 ][ 01.012 ] TIMED_WAITING - BLOCKED
[ 00:05.5037 ][ 05.037 ] Thread-1 
[ 00:05.5037 ][ 05.037 ] Thread-0 
[ 00:06.044 ][ 01.008 ] BLOCKED - TIMED_WAITING
```

</details>

<br/>

---

### ë¬¸ì œ 5.3 synchronized í‚¤ì›Œë“œì™€ ê°ì²´ë¥¼ ì´ìš©í•´ ë™ê¸°í™” ì‹œí‚¤ê¸°
- ì •ì  ë©”ì„œë“œëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.

### Code

<details>
    <summary> Example5_3 </summary>

```java
public class Example5_3 {

    static class Printer {
        public Printer() {
        }

        synchronized void printAndSleep(String message, long interval) throws InterruptedException {
            System.out.println(message);
            Thread.sleep(interval);
        }
    }

    static class Task extends Thread {
        boolean stopFlag;
        long interval;
        Printer printer;

        public Task(long interval, Printer printer) {
            this.stopFlag = true;
            this.interval = interval;
            this.printer = printer;
        }

        public boolean isStop() {
            return  this.stopFlag;
        }

        public void stop2() {
            this.stopFlag = true;
        }

        @Override
        public void run() {
            long    startTime = System.currentTimeMillis();
            long    previousPrintTime = 0;
            this.stopFlag = false;
            while(!this.isStop()) {
                try {
                    long totalElapsedTime = System.currentTimeMillis() - startTime;
                    long elapsedTime = totalElapsedTime - previousPrintTime;
                    String message = String.format("[ %02d:%02d.%03d ][ %02d.%03d ] %s",
                            totalElapsedTime / (60 * 1000), (totalElapsedTime / 1000) % 60, totalElapsedTime % 1000,
                            (elapsedTime / 1000), elapsedTime % 1000,
                            Thread.currentThread().getName());
                    this.printer.printAndSleep(message, this.interval);
                    previousPrintTime = totalElapsedTime;
                } catch (InterruptedException ignore) {
                }
            }
        }
    }

    public static void main(String [] args) throws InterruptedException {
        Printer printer = new Printer();
        Task task1 = new Task(3000, printer);
        Task task2 = new Task(5000, printer);

        task1.start();
        task2.start();

        long    startTime = System.currentTimeMillis();
        long    previousPrintTime = 0;

        for(int i = 0 ; i < 100 ; i++) {
            Thread.sleep(1000);
            if (i % 2 == 0) {
                task1.interrupt();
                task2.interrupt();
            }

            long totalElapsedTime = System.currentTimeMillis() - startTime;
            long elapsedTime = totalElapsedTime - previousPrintTime;
            System.out.printf("[ %02d:%02d.%03d ][ %02d.%03d ] %s - %s\n",
                    totalElapsedTime / (60 * 1000), (totalElapsedTime / 1000) % 60, totalElapsedTime % 1000,
                    (elapsedTime / 1000), elapsedTime % 1000,
                    task1.getState(), task2.getState());
            previousPrintTime = totalElapsedTime;
        }

        task1.stop2();
        task2.stop2();
    }
}
```

```java
// ì¶œë ¥
[ 00:00.000 ][ 00.000 ] Thread-1
[ 00:01.006 ][ 01.006 ] BLOCKED - TIMED_WAITING
[ 00:00.000 ][ 00.000 ] Thread-0
[ 00:01.007 ][ 01.007 ] Thread-1
[ 00:02.012 ][ 01.006 ] BLOCKED - TIMED_WAITING
[ 00:03.021 ][ 01.009 ] BLOCKED - TIMED_WAITING
[ 00:01.007 ][ 01.007 ] Thread-0
[ 00:03.021 ][ 03.021 ] Thread-1
[ 00:04.032 ][ 01.011 ] BLOCKED - TIMED_WAITING
[ 00:05.041 ][ 01.009 ] BLOCKED - TIMED_WAITING
[ 00:03.027 ][ 03.027 ] Thread-0
[ 00:05.042 ][ 05.042 ] Thread-1
[ 00:06.050 ][ 01.009 ] BLOCKED - TIMED_WAITING
[ 00:07.058 ][ 01.008 ] BLOCKED - TIMED_WAITING
```

</details>

<br/>

### Comment 
- ë©”ì„œë“œì— synchronizedë¥¼ ë¶™ì—¬ì„œ ì‚¬ìš©.

---
### ë¬¸ì œ 5.4 
- ì •ì  ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.
- ë©”ì†Œë“œì— synchronizedë¥¼ ì´ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.

### Code

<details>
    <summary> Example5_4 </summary> 

```java
public class Example5_4 {
    
    static class Printer {
        public Printer() {
        }

        void printAndSleep(String message, long interval) throws InterruptedException {
            synchronized (this) {
                System.out.println(message);
                Thread.sleep(interval);
            }
        }
    }

    static class Task extends Thread {
        boolean stopFlag;
        long interval;
        Printer printer;

        public Task(long interval, Printer printer) {
            this.stopFlag = true;
            this.interval = interval;
            this.printer = printer;
        }

        public boolean isStop() {
            return  this.stopFlag;
        }

        public void stop2() {
            this.stopFlag = true;
        }

        @Override
        public void run() {
            long    startTime = System.currentTimeMillis();
            long    previousPrintTime = 0;
            this.stopFlag = false;
            while(!this.isStop()) {
                try {
                    long totalElapsedTime = System.currentTimeMillis() - startTime;
                    long elapsedTime = totalElapsedTime - previousPrintTime;
                    String message = String.format("[ %02d:%02d.%03d ][ %02d.%03d ] %s",
                            totalElapsedTime / (60 * 1000), (totalElapsedTime / 1000) % 60, totalElapsedTime % 1000,
                            (elapsedTime / 1000), elapsedTime % 1000,
                            Thread.currentThread().getName());
                    this.printer.printAndSleep(message, this.interval);
                    previousPrintTime = totalElapsedTime;
                } catch (InterruptedException ignore) {
                }
            }
        }
    }

    public static void main(String [] args) throws InterruptedException {
        Printer printer = new Printer();
        Task task1 = new Task(3000, printer);
        Task task2 = new Task(5000, printer);

        task1.start();
        task2.start();

        long    startTime = System.currentTimeMillis();
        long    previousPrintTime = 0;

        for(int i = 0 ; i < 100 ; i++) {
            Thread.sleep(1000);
            if (i % 2 == 0) {
                task1.interrupt();
                task2.interrupt();
            }

            long totalElapsedTime = System.currentTimeMillis() - startTime;
            long elapsedTime = totalElapsedTime - previousPrintTime;
            System.out.printf("[ %02d:%02d.%03d ][ %02d.%03d ] %s - %s\n",
                    totalElapsedTime / (60 * 1000), (totalElapsedTime / 1000) % 60, totalElapsedTime % 1000,
                    (elapsedTime / 1000), elapsedTime % 1000,
                    task1.getState(), task2.getState());
            previousPrintTime = totalElapsedTime;
        }

        task1.stop2();
        task2.stop2();
    }
}
```

```java
// ì¶œë ¥
[ 00:00.000 ][ 00.000 ] Thread-0
[ 00:01.000 ][ 01.000 ] TIMED_WAITING - BLOCKED
[ 00:00.000 ][ 00.000 ] Thread-1
[ 00:01.001 ][ 01.001 ] Thread-0
[ 00:02.006 ][ 01.006 ] TIMED_WAITING - BLOCKED
[ 00:03.015 ][ 01.009 ] TIMED_WAITING - BLOCKED
[ 00:01.001 ][ 01.001 ] Thread-1
[ 00:03.015 ][ 03.015 ] Thread-0
[ 00:04.025 ][ 01.010 ] TIMED_WAITING - BLOCKED
[ 00:05.037 ][ 01.012 ] TIMED_WAITING - BLOCKED
[ 00:03.021 ][ 03.021 ] Thread-1
[ 00:05.037 ][ 05.037 ] Thread-0
[ 00:06.044 ][ 01.007 ] TIMED_WAITING - BLOCKED
[ 00:07.049 ][ 01.005 ] TIMED_WAITING - BLOCKED
[ 00:05.042 ][ 05.042 ] Thread-1
[ 00:07.050 ][ 07.050 ] Thread-0
```

</details>

<br/>

### Comment
- ë©”ì„œë“œ ì•ˆì—ì„œ synchronized (this) { } ì´ëŸ° ë°©ì‹ìœ¼ë¡œ êµ¬í˜„.

---

### ë§ˆë¬´ë¦¬...
ìŠ¤ë ˆë“œì— ê´€í•´ì„œ ë¬¸ì œë¥¼ 1ë²ˆë¶€í„° 5ë²ˆê¹Œì§€ í’€ì—ˆëŠ”ë° ë¬¸ì œ í•˜ë‚˜í•˜ë‚˜ ì´í•´í•˜ê¸° ë°”ë¹´ë‹¤. í•œ ë¬¸ì œ ì´í•´ë¥¼ í•˜ë©´ ë‹¤ìŒ ë¬¸ì œëŠ” ë˜ ìƒˆë¡œìš´ ëŠë‚Œì¸ ìƒíƒœì˜€ë‹¤....
í•œ ê°œë…ë¥¼ ì´í•´í•˜ê³  ë„˜ì–´ê°€ë©´ ë˜ ìƒˆë¡œìš´ ê°œë…ì— ëŒ€í•´ì„œëŠ” ë¨¸ë¦¬ê°€ í•˜ì–—ê²Œ ë˜ì„œ ë³µìŠµì´ë¼ë„ ë§ì´ í•˜ë ¤ í•œë‹¤.*(ì •ë¦¬ í›„ì—)*  
Java ì •ì„ì— ìŠ¤ë ˆë“œ íŒŒíŠ¸ë¥¼ ì¢€ ë°˜ë³µí•´ì„œ ì½ì–´ë³´ë ¤ í•œë‹¤.  
  
ì˜¤ëŠ˜ ë‚´ìš©ë„ ì°¸ í˜ë“¤ì—ˆë‹¤.... ë‚´ì¼ë„ ìŠ¤ë ˆë“œ ë¬¸ì œë¥¼ í‘¼ë‹¤ê³  í–ˆëŠ”ë° í°ì¼ë‚œê±° ê°™ë‹¤ğŸ˜­ğŸ˜­