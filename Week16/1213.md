# 1213 ì •ë¦¬

### Spring Boot 2ì¼ì°¨

---

### Auto Configuration

<br/>

**@EnableAutoConfiguration**
- Auto Configurationì€ ì–´í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ í•„ìš”í•œ Beanì„ ìœ ì¶”í•´ì„œ êµ¬ì„±í•´ì£¼ëŠ” ê¸°ëŠ¥ì„ ë‹´ë‹¹
- `@SpringBootApplication`ì— í¬í•¨
- 2.6.x ë²„ì „ ì´ì „
    - `pring-boot-autoconfigure/META-INF/spring.factories`ì— ì„¤ì •
- 2.7.x ë²„ì „ ì´í›„
    - `spring-boot-autoconfigure/META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports`ì— ì„¤ì •

**AutoConfiguration ì œì™¸**
- excludeë¥¼ ì‚¬ìš©í•´ì„œ ì œì™¸í•  ì„¤ì •ë“¤ì„ ì§€ì •
```java
@SpringBootApplication(exclude= RedisAutoConfiguration.class)
public class StudentApplication {
    public static void main(String[] args) {
        SpringApplication.run(StudentApplication.class, args);
    }
}
```

<br/>

**@Conditional**
- Spring Framework 4.0ë¶€í„° ì œê³µ
- ì„¤ì •ëœ ëª¨ë“  Condition ì¸í„°í˜ì´ìŠ¤ ì¡°ê±´ì´ TRUEì¸ ê²½ìš° ë™ì‘

<br/>

**@Conditional ì¢…ë¥˜**
|êµ¬ë¶„|	ë‚´ìš©	|ë¹„ê³ |
|---|---|---|
|@ConditionalOnWebApplication	|í”„ë¡œì íŠ¸ê°€ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ë©´ ì„¤ì • ë™ì‘|	-|
|@ConditionalOnBean|	í•´ë‹¹ Bean ì´ Spring Context ì— ì¡´ì¬í•˜ë©´ ë™ì‘|	Auto configuration only|
|@ConditionalOnMissingBean|	í•´ë‹¹ Bean ì´ Spring Context ì— ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ë™ì‘	|Auto configuration only|
|@ConditionalOnClass|	í•´ë‹¹ í´ë˜ìŠ¤ê°€ ì¡´ì¬í•˜ë©´ ìë™ì„¤ì • ë“±ë¡	|-|
|@ConditionalOnMissingClass|	í•´ë‹¹ í´ë˜ìŠ¤ê°€ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ìë™ì„¤ì • ë“±ë¡	|-|
|@ConditionalOnResource	|ìì›ì´(file ë“±) ì¡´ì¬í•˜ë©´ ë™ì‘	|-|
|@ConditionalOnProperty	|í”„ë¡œí¼í‹°ê°€ ì¡´ì¬í•˜ë©´ ë™ì‘	|-|
|@ConditionalOnJava	|JVM ë²„ì „ì— ë”°ë¼ ë™ì‘ì—¬ë¶€ ê²°ì •	|-|
|@ConditionalOnWarDeployment|	ì „í†µì ì¸ war ë°°í¬ ë°©ì‹ì—ì„œë§Œ ë™ì‘|	-|
|@ConditionalOnExpression	|SpEL ì˜ ê²°ê³¼ì— ë”°ë¼ ë™ì‘ì—¬ë¶€ ê²°ì •	|-|

<br/>

**@Conditional ì‹¤ìŠµ**
- [ë§í¬ ğŸ”‘](https://github.com/unhas01/nhnacademy/tree/master/Week16/edu-springboot-conditional-workshop)

<br/>

**Externalized Configuration**
- Spring Bootì—ì„  ê°™ì€ ì†ŒìŠ¤ì½”ë“œë¡œ ì—¬ëŸ¬ í™˜ê²½ì—ì„œ ë™ì‘í•  ìˆ˜ ìˆë„ë¡ ì™¸ë¶€í™” ì„¤ì •ì„ ì œê³µ
- `Java properties`, `yaml`, `í™˜ê²½ë³€ìˆ˜`, `ì‹¤í–‰ ì¸ì`ë¡œ ì„¤ì • ê°€ëŠ¥
- ì „ì²´ í”„ë¡œì íŠ¸ ì„¤ì •ì€ properties, yaml ì¤‘ í•˜ë‚˜ë§Œ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œì¥
- yamlë³´ë‹¤ propertiesê°€ ìš°ì„ ìˆœìœ„

<br/>

**ì„¤ì • ë°©ë²•**
- application.properties
```
server.port = 8888
```
- í™˜ê²½ë³€ìˆ˜
```
$ SERVER_PORT=8888 java â€“jar target/student.jar 
```
- ì‹¤í–‰ ëª…ë ¹ì–´ ì¸ì (Command Line argument)
```
$ java â€“jar target/student.jar --server.port=8888
```

<br/>

**ì„¤ì •ê°’ ë°”ì¸ë”© ë°©ë²•**
- @Value
    ```java
    @Component
    public class MyBean { 

        @Value("${nhn.student.name}") 
        private String name; 
    }
    ```
- @ConfigurationProperties
    - ì†ì„±ê°’(properties)ì„ @ConfigurationPropertiesë¡œ ë°”ì¸ë”©í•˜ì—¬ ì‚¬ìš©
    ```java
    @Getter
    @Setter
    @ConfigurationProperties(â€nhn.student")
    public class StudentProperties {
        private String name;
    }
    ```

<br/>

**ìë™ì™„ì„±**
- ë©”íƒ€ë°ì´í„°ë¥¼ ìë™ ìƒì„±
```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-configuration-processor</artifactId>
    <optional>true</optional>
</dependency>
```

<br/>


**@ConfigurationProperties í™œì„±í™”**

1. @ConfigurationPropertiesScan
    - Scanì„ í†µí•´ Beanìœ¼ë¡œ í™œì„±í™”
    - ì„¤ì •í•œ í´ë˜ìŠ¤ì˜ base package í•˜ìœ„ ëª¨ë“  @ConfigurationProperties ìŠ¤ìº”
    ```java
    @SpringBootApplication
    @ConfigurationPropertiesScan
    public class StudentApplication {
        public static void main(String[] args) {
            SpringApplication.run(StudentApplication.class, args);
        }
    }
    ```
1. @EnableConfigurationProperties
    - valueì— ì§€ì •í•œ ConfigurationProperties í´ë˜ìŠ¤ë¥¼ Bean ìœ¼ë¡œ í™œì„±í™”
    ```java
    @SpringBootApplication
    @EnableConfigurationProperties(value= SystemNameProperties.class) 
    public class StudentApplication {
        public static void main(String[] args) {
            SpringApplication.run(StudentApplication.class, args);
        }
    }
    ```

<br/>

**Spring Profile**
- í”„ë¡œí•„ ì§€ì • ì„¤ì •íŒŒì¼ì€ spring.profiles.active ì¸ìë¡œ ë¡œë”© ì—¬ë¶€ê°€ ê²°ì •
- prod í”„ë¡œíŒŒì¼ì„ ì§€ì •í–ˆë‹¤ë©´ application.properties ì™€ application-prod.properties ë¥¼ ëª¨ë‘ ë¡œë”©
```
$ java â€“jar target/student.jar --spring.profiles.active=prod
```

<br/>

**Externalized Configuration ìš°ì„ ìˆœìœ„**
1. application.properties
1. OS í™˜ê²½ ë³€ìˆ˜
1. SPRING_APPLICATION_JSON
1. ì‹¤í–‰ ëª…ë ¹ì–´ì™€ í•¨ê»˜ ì „ë‹¬ëœ ì¸ì
    - java -jar student.jar --server.port=9999
1. @TestPropertiesSource

<br/>

**Application Properties ìš°ì„ ìˆœìœ„**
- ì‹¤í–‰ ì¸ìë¡œ ì œê³µí•˜ëŠ” spring.profiles.active ì„¤ì •ìœ¼ë¡œ application-{profile}.properties ë¥¼ ì‚¬ìš©í•  ê²ƒì¸ì§€ ê²°ì •
- ì¤‘ë³µë˜ëŠ” ê²½ìš°, Override
1. application.properties (inside jar)	
    - Jar íŒŒì¼ ë‚´ì˜ application.properties	
1. application-{profile}.properties (inside jar)	
    - Jar íŒŒì¼ ë‚´ì˜ application-{profile}.properties	
1. application.properties (outside jar)
    - Jar íŒŒì¼ ë°–ì˜ application-{profile}.properties	
1. application-{profile}.properties(outside jar)	
    - Jar íŒŒì¼ ë°–ì˜ application-{profile}.properties

<br/>

**Application Properties ìš°ì„ ìˆœìœ„**
- application.properties ìœ„ì¹˜ë¥¼ ì°¾ì•„ê°€ëŠ” ìˆœì„œì— ë”°ë¼ ìµœì¢… ì„¤ì •ì´ ê²°ì •
1. Classpath root	
    - classpath:/application.properties	
1. Classpathì˜ /config íŒ¨í‚¤ì§€
    - classpath:/config/application.properties	
1. ì‹¤í–‰ ë””ë ‰í† ë¦¬	
    - ${current directory}/application.properties	
1. ì‹¤í–‰ ë””ë ‰í† ë¦¬ì˜ config ë””ë ‰í† ë¦¬	
    - ${current directory}/config/application.properties


<br/>

---

### Developer Tools

<br/>

**ê°œë°œì ë„êµ¬**
- ìë™ì¬ì‹œì‘
- ë¼ì´ë¸Œë¦¬ë¡œë“œ
- ì „ì—­ ì„¤ì •
- ì›ê²© ì–´í”Œë¦¬ì¼€ì´ì…˜

<Br/>

**Dependency**
- pom.xml
```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-devtools</artifactId>
    <optional>true</optional>
</dependency>
```

<br/>

**ê°œë°œì ë„êµ¬ ë¹„í™œì„±í™”**
- java -jarë¡œ ì‹¤í–‰í•˜ë©´ ìƒìš©í™˜ê²½ìœ¼ë¡œ íŒë‹¨í•˜ê³  ë¹„í™œì„±í™”ë¨
- -Dspring.devtools.restart.enabled=false ì„¤ì • í•„ìš”
- maven pluginì˜ repackagedë¡œ ìƒì„±ëœ ë°”ì´ë„ˆë¦¬ íŒŒì¼ì—ëŠ” ìë™ìœ¼ë¡œ devtoolsê°€ ì œê±°ë¨

<Br/>

**ë¼ì´ë¸Œ ë¦¬ë¡œë“œ**
- spring-boot-devtools ì— ë¼ì´ë¸Œ ë¦¬ë¡œë“œ ì„œë²„ê°€ í¬í•¨
- ìë™ ì¬ì‹œì‘(Automatic Restart) ë  ì‹œ ë¸Œë¼ìš°ì € ìë™ ìƒˆë¡œê³ ì¹¨
- í™•ì¥íŒ© ì„¤ì¹˜
    - https://chrome.google.com/webstore/detail/livereload/jnihajbhpnppcggbcgedagnkighmdlei

<br/>

---
### ê³¼ì œ

**ìš”êµ¬ì‚¬í•­**
- Account ì‹œìŠ¤í…œì„ `Back End ì„œë²„`, `Open Api ì„œë²„` 2ê°œì˜ í”„ë¡œì íŠ¸ë¥¼ ìƒì„±
- Open Api
    - ì™¸ë¶€ì— ì œê³µí•  Rest Apië¥¼ ì œê³µ
- Back End ì„œë²„ 
    - Account ì‹œìŠ¤í…œ ê¸°ëŠ¥ì„ RestControllerë¡œ êµ¬í˜„í•˜ì—¬ JSON í˜•ì‹ìœ¼ë¡œ ë°˜í™˜

<br>

**êµ¬ì„±**
![image](https://user-images.githubusercontent.com/87689191/209458348-c0ebb7ea-4cb1-44e5-9e9d-89fb4067137b.png)

<br/>

**ì½”ë“œ**
- Back End : [ë§í¬ ğŸ”‘](https://github.com/unhas01/nhnacademy/tree/master/Week16/student-back)
- Open Api : [ë§í¬ ğŸ”‘](https://github.com/unhas01/nhnacademy/tree/master/Week16/student-open)


