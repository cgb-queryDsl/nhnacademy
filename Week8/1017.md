# 1017 ì •ë¦¬

ì»´í“¨í„° Networkì— ëŒ€í•´ ë°°ì› ë˜ ì‹œê°„

---

### HTTP ë™ì‘ ë°©ì‹

<img width="822" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-17 á„‹á…©á„’á…® 5 02 10" src="https://user-images.githubusercontent.com/87689191/196122089-99ba7ced-9e33-436b-baac-5d4c1181a507.png">

1. Connect
1. Request
1. Response
1. Close

---
### ë„¤íŠ¸ì›Œí¬

<br/>

**ë„¤íŠ¸ì›Œí¬ ì—£ì§€**
- ë„¤íŠ¸ì›Œí¬ ë””ë°”ì´ìŠ¤
- access networks, physical media

<br/>

**ë„¤íŠ¸ì›Œí¬ ì½”ì–´**
- ì—°ê²°ëœ ë¼ìš°í„°ë“¤ì˜ mesh
- ë„¤íŠ¸ì›Œí¬ ë©”ì‹œì§€ë¥¼ ì „ë‹¬

<Br/>

**ìŠ¤ìœ„ì¹­**
- ì„œí‚· ìŠ¤ìœ„ì¹­ (Circuit Switching)
    - ì˜›ë‚  ì „í™”ë§ PSTNì—ì„œ ì‚¬ìš©
- íŒ¨í‚· ìŠ¤ìœ„ì¹­ (Packet Switching)
    - í˜„ì¬ì˜ ì¸í„°ë„· (ì§€ê¸ˆìœ ê±°ì˜ íŒ¨í‚· ìŠ¤ìœ„ì¹­ì„ ì‚¬ìš©)

<br/>

**íŒ¨í‚·ì˜ ì´ë™**

![Packet_Switching](https://user-images.githubusercontent.com/87689191/196123198-61e326c0-24f9-458d-a74f-d9d663bd959a.gif)

<br/>

**ë„¤íŠ¸ì›Œí¬ í”„ë¡œí† ì½œ**
- ì»´í“¨í„°ë‚˜ ì›ê±°ë¦¬ í†µì‹  ì¥ë¹„ ì‚¬ì´ì—ì„œ ë©”ì‹œì§€ë¥¼ ì£¼ê³  ë°›ëŠ” ì–‘ì‹ê³¼ ê·œì¹™ì˜ ì²´ê³„

<br/>

---

### L7 ì‘ìš©ê³„ì¸µ
- ì‹¤ì œ ë„¤íŠ¸ì›Œí¬ ì• í”Œë¦¬ì¼€ì´ì…˜ë“¤ì´ ë‹¤ë£¨ëŠ” ì˜ì—­
- ëŒ€í‘œì ì¸ í”„ë¡œí† ì½œ
    - HTTP, DHCP, SMTP, FTP

<br/>

**ì‹¤ìŠµ : curl í”„ë¡œê·¸ë¨ìœ¼ë¡œ í™•ì¸**
- ubuntuì—ì„œ ì‹¤í–‰
```
$ curl http://httpbin.org/get?msg=hello
```
```
{
  "args": {
    "msg": "hello"
  },
  "headers": {
    "Accept": "*/*",
    "Host": "httpbin.org",
    "User-Agent": "curl/7.68.0",
    "X-Amzn-Trace-Id": "Root=1-634d0ed8-6ccbf76e07c03fe311154ac0"
  },
  "origin": "133.186.223.194",
  "url": "http://httpbin.org/get?msg=hello"
}
```

<br/>

**ì‹¤ìŠµ : tcpdumpë¡œ í™•ì¸**
```
$ tcpdump -nnn -i eth0 -X tcp port 80
```

```
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes
17:16:47.825818 IP 192.168.0.91.55856 > 169.254.169.254.80: Flags [S], seq 696955396, win 65044, options [mss 1414,sackOK,TS val 1375317936 ecr 0,nop,wscale 7], length 0
	0x0000:  4500 003c 2712 4000 4006 fea9 c0a8 005b  E..<'.@.@......[
	0x0010:  a9fe a9fe da30 0050 298a b204 0000 0000  .....0.P).......
	0x0020:  a002 fe14 152f 0000 0204 0586 0402 080a  ...../..........
	0x0030:  51f9 afb0 0000 0000 0103 0307            Q...........
17:16:47.826340 IP 169.254.169.254.80 > 192.168.0.91.55856: Flags [S.], seq 1335813416, ack 696955397, win 29200, options [mss 1460,nop,nop,sackOK,nop,wscale 9], length 0
	0x0000:  4500 0034 0000 4000 4006 25c4 a9fe a9fe  E..4..@.@.%.....
	0x0010:  c0a8 005b 0050 da30 4f9e e528 298a b205  ...[.P.0O..()...
	0x0020:  8012 7210 fd16 0000 0204 05b4 0101 0402  ..r.............
	0x0030:  0103 0309
.......
```

<br/>

**DNS**
- Domain Name Service
- ë„ë©”ì¸ ì£¼ì†Œë¥¼ IPë¡œ ë³€í™˜í•´ì£¼ëŠ” ì„œë¹„ìŠ¤
    - ë¸Œë¼ìš°ì €ëŠ” ë¨¼ì € DNSì— ê°€ì„œ IPë¥¼ ì–»ì–´ëƒ„
    - ì–»ì–´ë‚¸ IPë¡œ ì ‘ì†

<br/>

**ì‹¤ìŠµ**
- ubuntuì—ì„œ ì‹¤í–‰

```
$ nslookup naver.com
```

```
Server:		127.0.0.53
Address:	127.0.0.53#53

Non-authoritative answer:
Name:	naver.com
Address: 223.130.195.95
Name:	naver.com
Address: 223.130.195.200
Name:	naver.com
Address: 223.130.200.107
Name:	naver.com
Address: 223.130.200.104
```

<br/>

- naver.comì˜ ì´ë©”ì¼ IPì£¼ì†Œ í™•ì¸

```
$ nslookup -q=mx naver.com
```

```
Server:		127.0.0.53
Address:	127.0.0.53#53

Non-authoritative answer:
naver.com	mail exchanger = 10 mx3.naver.com.
naver.com	mail exchanger = 10 mx1.naver.com.
naver.com	mail exchanger = 10 mx2.naver.com.

Authoritative answers can be found from:
```

<br/>

**DNS êµ¬ì„±**

<img width="814" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-17 á„‹á…©á„’á…® 5 24 30" src="https://user-images.githubusercontent.com/87689191/196126697-a17776b9-f354-4212-bd2f-848946411e6d.png">

- ìì‹ ì˜ ë„ë©”ì¸ì€ ìì‹ ì´ ì±…ì„ ì§€ëŠ” êµ¬ì¡°

<br/>

**Query Flow**

<img width="821" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-17 á„‹á…©á„’á…® 5 25 26" src="https://user-images.githubusercontent.com/87689191/196126885-949df1b5-0921-490a-ae44-71fac5976404.png">

- Local DNSì— ìºì‹±ì´ ë˜ì–´ ìˆëŠ” ê²½ìš° ë°”ë¡œ ì‘ë‹µ
- ìºì‹±ì´ ë˜ì–´ ìˆì§€ ì•ŠëŠ” ê²½ìš°
    - Root -> TLD -> Authoratative ìˆœìœ¼ë¡œ ì§ˆì˜í•˜ì—¬ ê²°ê³¼ ì‘ë‹µ

<br/>

---

### L4 ì „ì†¡ê³„ì¸µ

<br/>

**í”„ë¡œí† ì½œ ìŠ¤íƒ**

<img width="820" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-17 á„‹á…©á„’á…® 5 27 51" src="https://user-images.githubusercontent.com/87689191/196128287-3903e67f-ddfb-4673-93eb-66f4b3f3f610.png">

- í•œ ê³„ì¸µì„ ë‚´ë ¤ê°ˆ ë•Œ ë§ˆë‹¤ í—¤ë”ê°€ ì¶”ê°€
- í•œ ê³„ì¸µì„ ì˜¬ë¼ê°ˆ ë•Œ ë§ˆë‹¤ í—¤ë”ê°€ ì œê±°

<br/>

**ì „ì†¡ê³„ì¸µ**
- ì‹ ë¢°ì„± ìˆëŠ” ì „ì†¡ ê¸°ëŠ¥ ì œê³µ
- End-to-End

<br/>

**UDP Protocol**
- ì‹ ë¢°ì„±ì´ ì—†ìŒ
- ê·¸ëƒ¥ ë°”ë¡œ ë³´ëƒ„
- íŒŒì¼ì´ ê¹¨ì§„ ì •ë„ëŠ” checksumì„ í†µí•´ ì²´í¬ ê°€ëŠ¥
- ì¼ë°˜ì ìœ¼ë¡œ TCPë³´ë‹¨ ë¹ ë¦„
- ë³´í†µ ì „í™”í†µí™” ê°™ì€ ê³³ì—ì„œ ì‚¬ìš©
```
Format
------
                        
        0      7 8     15 16    23 24    31  
        +--------+--------+--------+--------+ 
        |     Source      |   Destination   | 
        |      Port       |      Port       | 
        +--------+--------+--------+--------+ 
        |                 |                 | 
        |     Length      |    Checksum     | 
        +--------+--------+--------+--------+ 
        |                                     
        |          data octets ...            
        +---------------- ...                 

            User Datagram Header Format
```

<br/>

**TCP Protocol**
- ì‹ ë¢°ì„±ì´ ìˆìŒ
- ìˆœì„œë„ ë§ì¶°ì¤Œ
- ë°ì´í„°ê°€ ëˆ„ë½ë˜ì§€ ì•ŠìŒ
```
TCP Header Format
                                    
    0                   1                   2                   3   
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |          Source Port          |       Destination Port        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Sequence Number                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                    Acknowledgment Number                      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Data |           |U|A|P|R|S|F|                               |
   | Offset| Reserved  |R|C|S|S|Y|I|            Window             |
   |       |           |G|K|H|T|N|N|                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |           Checksum            |         Urgent Pointer        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                    Options                    |    Padding    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                             data                              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                            TCP Header Format
```

<br/>

**Well-Known í¬íŠ¸**
- í”„ë¡œí† ì½œì— ê³ ì • í¬íŠ¸ ë²ˆí˜¸ë¥¼ ë¶€ì—¬
    - HTTP 80
    - DNS 53
    - SMTP 25
- í¬íŠ¸ ë²ˆí˜¸ í™•ì¸
```
$ cat /ect/services
```

**TCP ì»¤ë„¥ì…˜**
- 3 way handshake

<img width="484" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-17 á„‹á…©á„’á…® 5 35 43" src="https://user-images.githubusercontent.com/87689191/196130254-86ad8811-9d84-46a4-9981-9ab5c92613b6.png">

- ë°ì´í„° ì¬ì „ì†¡
    - case1
        - ìˆ˜ì‹ ì¸¡
            - ìˆ˜ì‹ í•œ íŒ¨í‚·ì˜ ACKë¥¼ ì „ì†¡
        - ì†¡ì‹ ì¸¡
            - íŠ¹ì • ì‹œê°„ë™ì•ˆ ë³´ë‚¸ íŒ¨í‚·ì— ëŒ€í•œ ACKê°€ ì—†ëŠ” ê²½ìš° ë‹¤ì‹œ ì „ì†¡
            - ì†¡ì‹  íŒ¨í‚·ì´ ì „ë‹¬ì´ ì•ˆ ëœ ê²½ìš° -> ìˆ˜ì‹  ì…ì¥ì—ì„œ ì ì •í•œ íŒ¨í‚·ì„ ë°›ì€(ì •ìƒ)
            - ìˆ˜ì‹  íŒ¨í‚·ì´ ì „ë‹¬ì´ ì•ˆ ëœ ê²½ìš° -> ìˆ˜ì‹  ì…ì¥ì—ì„œ ê°™ì€ íŒ¨í‚·ì„ ë‘ë²ˆ ë°›ìŒ -> ê°™ì€ íŒ¨í‚·ì— ëŒ€í•´ ë‹¤ì‹œ ACK

    - case2
        - ìˆ˜ì‹ ì¸¡
            - ìˆ˜ì‹ í•œ íŒ¨í‚·ì˜ ACKë¥¼ ì „ì†¡
                - ì¤‘ê°„ì— ëˆ„ë½ì´ ìˆìœ¼ë©´ ìˆœì„œê°€ ë§ì€ ë§ˆì§€ë§‰ íŒ¨í‚·ì˜ ACKë¥¼ ê³„ì† ì „ì†¡
        - ì†¡ì‹ ì¸¡
            - Duplicated ACKê°€ 3ë²ˆ ì˜¤ë©´ ì¬ì „ì†¡

<br/>

**TCP ì»¤ë„¥ì…˜ ëŠê¸°**

<img width="418" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-17 á„‹á…©á„’á…® 5 41 52" src="https://user-images.githubusercontent.com/87689191/196131594-4b19f70d-b21c-479d-8010-803d6a57b1c9.png">

- ì¢…ë£Œì‹œì—” 4way handshake
- ë§ˆì§€ë§‰ closedì˜ ACK í™•ì¸
    - ì¼ì • ì‹œê°„ë™ì•ˆ FINì— ëŒ€í•œ ACKê°€ ì˜¤ì§€ ì•Šìœ¼ë©´ FINì„ ì¬ì „ì†¡

<br/>

**Flow Control**
- TCP í—¤ë”ì˜ ìœˆë„ìš° í¬ê¸°
- ìˆ˜ì‹ ì¸¡ì—ì„œ ìˆ˜ì‹  ê°€ëŠ¥í•œ ë²„í¼ì˜ í¬ê¸°ì— ë§ê²Œ ë°ì´í„°ë¥¼ ë³´ë‚´ë©´ ë¨
    - ë°ì´í„° ìˆ˜ì‹  ì†ë„ì™€ ê´€ê³„ê°€ ìˆìŒ
- netstatìœ¼ë¡œ í™•ì¸ ê°€ëŠ¥
- ì˜ˆì‹œ) ì„¸ì°¨ì¥ì— 1ì‹œê°„ì— 10ëŒ€ë¥¼ ì²˜ë¦¬ ê°€ëŠ¥í•œë° ëª‡ ê°œê°€ ê³ ì¥ë‚˜ë©´ 10ëŒ€ ë³´ë‹¤ ì ì€ ì°¨ë¥¼ ë°›ì•„ì•¼ í•¨

<br/>

**Congestion Control**
- flowì™€ ë‹¤ë¦„
- network ë¬¸ì œ
    - TCPê°€ ì—´ì‹¬íˆ ì¶”ì í•´ì•¼ í•¨
- ss -i ëª…ë ¹ì–´ë¡œ í™•ì¸ ê°€ëŠ¥
- ì˜ˆì‹œ) ì„¸ì°¨ì¥ìœ¼ë¡œ ê°€ëŠ” ë„ë¡œì˜ ê¸¸ì´ ë§‰íˆëŠ” ìƒí™© (ëª¨ë“  ì°¨ë¥¼ ê±·ì–´ë‚´ì§€ ì•Šìœ¼ë©´ í•´ê²°ì´ ì–´ë ¤ì›€)
- ì˜ˆì‹œ

<img width="816" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-17 á„‹á…©á„’á…® 5 46 52" src="https://user-images.githubusercontent.com/87689191/196132642-6d4a6e2f-cb86-41a5-adde-15041d63f328.png">

---

### L3 ë„¤íŠ¸ì›Œí¬ ê³„ì¸µ

<br/>

**Network Layer**

- ë°ì´í„°ë¥¼ ì „ì†¡, ê²½ë¡œë¥¼ ê²°ì •

<img width="812" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-17 á„‹á…©á„’á…® 5 49 43" src="https://user-images.githubusercontent.com/87689191/196133240-d71a3add-7d09-4c59-8f6f-78634b23a9cd.png">

- X ëª¨ì–‘ : ë¼ìš°í„°
- ê²½ë¡œë¥¼ ê²°ì •í•´ì„œ íŒ¨í‚·ì„ ì „ì†¡ (í¬ì›Œë”©)

<br/>

**IPv4 Protocol**

```
1 	ICMP 	Internet Control Message 		[RFC792]
2 	IGMP 	Internet Group Management 		[RFC1112]
6 	TCP 	Transmission Control 		[RFC-ietf-tcpm-rfc793bis-28]
8 	EGP 	Exterior Gateway Protocol 		[RFC888][David_Mills]
9 	IGP 	any private interior gateway (used by Cisco for their IGRP) 		[Internet_Assigned_Numbers_Authority]
17 	UDP 	User Datagram 		[RFC768][Jon_Postel]
```

<Br/>

**Subnet**

<img width="793" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-17 á„‹á…©á„’á…® 5 53 09" src="https://user-images.githubusercontent.com/87689191/196134054-cf37d161-e0b9-4bc1-b2f8-8c72f356d0ba.png">

- ë¼ìš°í„°ë¥¼ í†µí•˜ì§€ ì•Šê³  ê°ˆ ìˆ˜ ìˆëŠ” ë„¤íŠ¸ì›Œí¬
- ê·¸ë¦¼ì—ì„œ Subnetì€ 3ê°œ

<br/>

**ë¼ìš°íŒ…**
- í¬ì›Œë”© í…Œì´ë¸”ì„ ë§Œë“ ë‹¤

<br/>

**í¬ì›Œë”©**

<img width="752" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-17 á„‹á…©á„’á…® 5 55 01" src="https://user-images.githubusercontent.com/87689191/196134477-9e8f74fd-4232-4b1d-8e42-cf5894195d15.png">

<br/>

- ë¼ìš°íŒ… í…Œì´ë¸” í™•ì¸
```
$ route
```

<br/>

**NAT**
- Network Address Translation

<img width="478" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-10-17 á„‹á…©á„’á…® 5 56 34" src="https://user-images.githubusercontent.com/87689191/196134846-c6ef352b-f9af-44f8-962b-de2676e0d48b.png">

- ë¼ìš°í„°ì—ì„œ `source`ì™€ `destinatino`ì„ ì„¸íŒ…í•´ì¤Œ
- **ì¥ì **
    - IP ê³ ê°ˆì„ ê±±ì •í•˜ì—¬ ë§Œë“  ê¸°ëŠ¥
    - SRC PORTë„ ë³€ê²½ì´ ë¨
- **ë‹¨ì **
    - ì„œë²„ ìš´ì˜ì´ ë¶ˆê°€ëŠ¥
    - ì„œë¡œ ë‹¤ë¥¸ NATí™˜ê²½ì˜ ë‘ í˜¸ìŠ¤íŠ¸ê°€ ì§ì ‘ í†µì‹ í•˜ëŠ” ê²ƒì´ ì–´ë ¤ì›€

---
### ê³¼ì œ

<br/>

**snc(simple-nc) ë§Œë“¤ê¸°**

- nc (netcat) í”„ë¡œê·¸ë¨ì´ ìˆìŠµë‹ˆë‹¤. ì´ í”„ë¡œê·¸ë¨ê³¼ ìœ ì‚¬í•˜ê²Œ ë™ì‘í•˜ëŠ” simple-nc ë¥¼ ì‘ì„±
- nc ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë™ì‘í•©ë‹ˆë‹¤.
    - í´ë¼ì´ì–¸íŠ¸ ëª¨ë“œ
        - ì…ë ¥ì¸ìë¡œ ë°›ì€ ì„œë²„ì— TCP ì—°ê²°
        - ì‚¬ìš©ìë¡œ ë¶€í„°ì˜ ì…ë ¥(STDIN)ì„ ì„œë²„ë¡œ ì „ì†¡
        - ì„œë²„ë¡œ ë¶€í„° ë°›ì€ ë°ì´íƒ€ëŠ” í‘œì¤€ ì¶œë ¥(STDOUT)
        - ctrl-c ë¡œ í”„ë¡œê·¸ë¨ì„ ì¢…ë£Œ
    - ì„œë²„ ëª¨ë“œ
        - ì…ë ¥ì¸ìë¡œ listen í¬íŠ¸ë¥¼ ì…ë ¥
        - í•´ë‹¹ í¬íŠ¸ë¡œ TCP ì„œë²„ë¥¼ ì‹¤í–‰í•˜ì—¬ ì ‘ì†ì„ ê¸°ë‹¤ë¦¼
        - í´ë¼ì´ì–¸íŠ¸ê°€ ì ‘ì†í•˜ì—¬ ë°ì´íƒ€ë¥¼ ë³´ë‚´ë©´, í‘œì¤€ ì¶œë ¥
        - ì‚¬ìš©ìì˜ ì…ë ¥(STDIN) ì„ í´ë¼ì´ì–¸íŠ¸ë¡œ ì „ì†¡
        - ctrl-c ë¡œ í”„ë¡œê·¸ë¨ì„ ì¢…ë£Œ

<br/>

**Server**
```
$ snc -l 3000
```
- ì„œë²„ë¡œ ë™ì‘
- ì…ë ¥ì„ ë°›ì•„ í´ë¼ì´ì–¸íŠ¸ì— ì „ì†¡
- í´ë¼ì´ì–¸íŠ¸ ì‘ë‹µì„ í‘œì¤€ ì¶œë ¥
- í•œ ì»¤ë„¥ì…˜ë§Œ ì²˜ë¦¬

<br/>

**Client**
```
$ snc 127.0.0.1 3000
```
- í´ë¼ì´ì–¸íŠ¸ë¡œ ë™ì‘
- ì…ë ¥ì„ ë°›ì•„ ì„œë²„ì— ì „ì†¡
- ì„œë²„ ì‘ë‹µì„ í‘œì¤€ ì¶œë ¥

<br/>

- ê³¼ì œ ì½”ë“œ : [ë§í¬ ğŸ”‘](https://github.com/unhas01/nhnacademy/tree/master/Week8/simple-nc)
- *ctrl-c ì¢…ë£ŒëŠ” êµ¬í˜„ ì‹¤íŒ¨*