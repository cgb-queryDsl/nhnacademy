# 1115 ì •ë¦¬

### Spring MVC 2ì¼ì°¨
---

**HttpMessageConverter**
- ìë°” ê°ì²´ì™€ HTTP ìš”ì²­/ì‘ë‹µ bodyë¥¼ ë³€í™˜í•˜ëŠ” ì—­í• 
- `@ResponseBody`ê°€ ìˆìœ¼ë©´ ì‘ë™

<img width="629" alt="image" src="https://user-images.githubusercontent.com/87689191/202900387-17c7b2db-72d7-454f-8338-87fa700abe91.png">

<br/>

**`@EnableWebMvc`**
- `WebMvcConfigurationSupport`ì—ì„œ default HttpMessageConverter ì§€ì›

<br/>

**`@ResponseBody`**
- HttpMessageConverterë¥¼ í†µí•´ **ì§ë ¬í™”** í•´ì„œ response bodyë¡œ ì „ë‹¬

<br/>

**ResponseEntity**
- `@ResponseBody` + http status + response headers
```java
@GetMapping("/something")
public ResponseEntity<String> handle() {
    String body = ... ;
    String etag = ... ;
    return ResponseEntity.ok()          // http status (200 OK)
                         .eTag(etag)    // response header (ETAG)
                         .build(body);  // response body
}
```

<br/>

**`@RequestBody`**
- request bodyë¥¼ ì½ì–´ì™€ì„œ HttpMessageConverterë¥¼ í†µí•´ **ì—­ì§ë ¬í™”** í•´ì„œ ê°ì²´ë¡œ ì „ë‹¬ ë°›ìŒ

<br/>

**users.http**
- RestController ë©”ì„œë“œ ì¶”ê°€ í›„ 
- `File> New> HTTP Request` íŒŒì¼ë¡œ ìƒì„±
```
POST http://localhost:8080/users HTTP/1.1
Content-type: application/json

{
  "id": "dongmyo",
  "password": "67890",
  "age": 19,
  "name": "ë™ë¬˜"
}
```

<br/>

**Handler**
- HandlerëŠ” ê·¸ëƒ¥ Controllerë¼ê³  ìƒê°í•´ë„ ë¬´ë°©


**HandlerMapping**
- BeanNameUrlHandlerMapping
    - Bean Name + Url + HandlerMapping
- SimpleUrlHandlerMapping
    - Simple Url + HandlerMapping
- RequestMappingHandlerMapping
    - @RequestMapping + HandlerMapping


<br/>

**HandlerAdapter**
- HttpRequestHandlerAdapter
    - HttpRequestHandler + HandlerAdapter
- SimpleControllerHandlerAdapter
    - Simple Controller + HandlerAdapter
- RequestMappingHandlerAdapter
    - @RequestMapping + HandlerAdapter

<br/>

**ViewResolber**
- ë¬¸ìì—´ ê¸°ë°˜ì˜ view ì´ë¦„ì„ ì‹¤ì œ view êµ¬í˜„ì„ ê²°ì •í•´ì¤Œ
- ê´€ë ¨ Components
    - LocaleResolver
    - LocaleContextResolver
    - ThemeResolver
    - RequestToViewNameTranslator
    - MultipartResolver
        - ë©€í‹° íŒŒíŠ¸ ìš”ì²­ ì²˜ë¦¬ë¥¼ êµ¬í˜„

<br/>

**HandlerInterceptor**
- Servlet Filterì™€ ìœ ì‚¬

<img width="879" alt="image" src="https://user-images.githubusercontent.com/87689191/202901275-aec0f203-f608-4a21-ae2a-88620b4e34b7.png">

<br/>

**Filter vs Interceptor**

<img width="249" alt="image" src="https://user-images.githubusercontent.com/87689191/202901322-6dfc9723-6a45-4bf6-8440-96d0ba3ac7b6.png">

- ì‹¤í–‰ ì‹œì ì´ ë‹¤ë¦„
    - Filter : `DispatcherServlet` ì‹¤í–‰ ì „/í›„ì— ì‹¤í–‰
    - HandlerInterceptor : `DispatcherServlet` ì‹¤í–‰ ì´í›„ì— Controller ì‹¤í–‰ ì „/í›„ì— ì‹¤í–‰
- ApplicationContext ë²”ìœ„ê°€ ë‹¤ë¦„
    - Filter : Root ApplicationContextì— ë“±ë¡/ê´€ë¦¬
    - HandlerInterceptor: Servlet ApplicationContextì— ë“±ë¡/ê´€ë¦¬

<br/>


**MessageSource**
- Bean ë“±ë¡
```java
@Bean
public MessageSource messageSource() {
    ResourceBundleMessageSource messageSource = new ResourceBundleMessageSource();
    messageSource.setBasename("message");

    return messageSource;
}
```


<br/>

**File Upload**
- MultipartResolver ì´ìš©
```java
@PostMapping("/fileUpload")
public String processUpload(@RequestParam("file") MultipartFile file,
                            @Value("${upload.dir}") String uploadDir,
                            Model model) throws IOException {
    file.transferTo(Paths.get(uploadDir + file.getOriginalFilename()));

    model.addAttribute("fileName", file.getOriginalFilename());
    model.addAttribute("size", file.getSize());

    return "uploadSuccess";
}
```

<br/>


**View**
- Thymeleaf
    - HTML 5 ê¸°ë°˜ì˜ view template engine

---

### ê³¼ì œ

1114ê³¼ì œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì¶”ê°€

<br/>

1. View ë³€ê²½
    - Jspë¥¼ Thymeleafë¡œ ë³€ê²½
1. ë‹¤êµ­ì–´ ì§€ì›
    - í•œêµ­ì–´/ì˜ì–´ ì§€ì›
        - ì–¸ì–´ ë³€ê²½ ê°€ëŠ¥
1. ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ ê¸°ëŠ¥ ì¶”ê°€
    - ë¡œê·¸ì¸ í•˜ì§€ ì•Šê³  ë‹¤ë¥¸ ê¸°ëŠ¥ ì‚¬ìš© ë¶ˆê°€(Interceptor ì‚¬ìš©)
1. REST API ì œê³µ - JSON ìš”ì²­/ì‘ë‹µ
    - í•™ìƒ ì •ë³´ ë“±ë¡: `POST /studens`
    - í•™ìƒ ì •ë³´ ì¡°íšŒ: `GET /students/{studentId}`
    - í•™ìƒ ì •ë³´ ìˆ˜ì •: `PUT /students/{studentId}`

<br/>

**ì½”ë“œ**
- ê³¼ì œ ì½”ë“œ : [ë§í¬ ğŸ”‘](https://github.com/unhas01/nhnacademy/tree/master/Week12/academy-spring-mvc-student-v2)






